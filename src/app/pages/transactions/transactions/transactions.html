<div class="page-header">
  <h2>Transactions</h2>
  <p>View full transaction history</p>
</div>

<div class="transaction-panel">
  <div class="tabs-container">
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'Normal'" 
      (click)="onTabChange('Normal')">
      Normal
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'Charges'" 
      (click)="onTabChange('Charges')">
      Charges
    </button>
    <button 
      class="tab-button" 
      [class.active]="activeTab === 'Settlements'" 
      (click)="onTabChange('Settlements')">
      Settlements
    </button>
  </div>
  
  <h3 class="panel-title">{{ activeTab }} Transaction History</h3>

  <div class="table-container">
    <div *ngIf="isLoading" class="loading-spinner-container">
      <mat-spinner diameter="40"></mat-spinner>
    </div>

    <table mat-table [dataSource]="transactions" class="data-table" *ngIf="!isLoading">
      
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef>Transactions <span class="material-icons sort-icon">swap_vert</span></th>
        <td mat-cell *matCellDef="let transaction">
          <div class="transaction-id">{{ transaction.id }}</div>
          <div class="transaction-details">
      <span class="sender-name">
        {{ transaction.sender_wallet?.name || transaction.from_name }}
      </span>

      <span class="material-icons detail-arrow">arrow_forward</span>

      <span class="recipient-name">
        {{ transaction.recipient_wallet?.name || transaction.to_name }}
      </span>
    </div>
        </td>
        
      </ng-container>

      <ng-container matColumnDef="details">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let transaction">
          <div class="transaction-details">
            {{ transaction.from_name }} &rarr; {{ transaction.to_name }}
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="date">
        <th mat-header-cell *matHeaderCellDef>Date</th>
        <td mat-cell *matCellDef="let transaction">
          <div class="transaction-date-main">
      {{ transaction.action_datetime | date:'d, MMM, y' }}
          </div>
          <div class="transaction-time">
      {{ transaction.action_datetime | date:'h:mm a' }}
            </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef>Amount</th>
        <td mat-cell *matCellDef="let transaction">
          <div class="transaction-amount">
            ${{ transaction.amount | number:'1.2-2' }}
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    
    <div *ngIf="transactions.length === 0 && !isLoading" class="no-data-message">
      No transactions available for this type.
    </div>

    <mat-paginator
      *ngIf="!isLoading && totalItems > pageSize"
      [length]="totalItems" 
      [pageSize]="pageSize"
      [pageIndex]="currentPage - 1"
      (page)="handlePageEvent($event)"
      showFirstLastButtons
      class="custom-paginator"
    >
    </mat-paginator>
  </div>
</div>
